# Network UPS Tools - upssched.conf
# Configuración de eventos y notificaciones temporizadas

# Directorio para archivos temporales/lock
CMDSCRIPT /etc/nut/upssched-cmd
PIPEFN /run/nut/upssched.pipe
LOCKFN /run/nut/upssched.lock

# Eventos y temporizadores
# Formato: AT <notifytype> <upsname> <command>

# Cuando se va la luz:
# 1. Notificar después de 30 segundos (evita spam por cortes breves)
# 2. Iniciar timer de shutdown de 20 minutos
AT ONBATT * START-TIMER onbatt 30
AT ONBATT * START-TIMER shutdown-timer 1200

# Si vuelve la luz, cancelar todos los timers
AT ONLINE * CANCEL-TIMER onbatt
AT ONLINE * CANCEL-TIMER shutdown-timer

# Batería baja - notificar inmediatamente
AT LOWBATT * EXECUTE lowbatt

# Cuando vuelve la luz
AT ONLINE * EXECUTE online

# Comunicación perdida - esperar 15s
AT COMMBAD * START-TIMER commbad 15
AT COMMOK * CANCEL-TIMER commbad

# Si no se puede comunicar después de 15s
AT COMMBAD * EXECUTE commbad

# Comunicación restaurada
AT COMMOK * EXECUTE commok

# Shutdown iniciado
AT SHUTDOWN * EXECUTE shutdown

# Batería necesita reemplazo
AT REPLBATT * EXECUTE replbatt
